"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__read=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),l=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)l.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return l},__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_this=this,react_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importStar(require("react"))),aphrodite_1=require("../../helpers/aphrodite"),Button_1=__importDefault(require("../Button")),Icon_1=__importDefault(require("../Icon")),Uploader_styles_1=__importDefault(require("./Uploader.styles")),iconType_1=__importDefault(require("./iconType")),Uploader=react_1.default.memo(function(i){var e,t=(0,Uploader_styles_1.default)(),r=__read((0,react_1.useState)(i.files||[]),2),l=r[0],o=r[1],r=__read((0,react_1.useState)(""),2),n=r[0],u=r[1],c=(0,react_1.useRef)(null),r=(0,react_1.useMemo)(function(){return l.map(function(e){return react_1.default.createElement("div",{className:(0,aphrodite_1.css)(t.fileItem),key:e.name},react_1.default.createElement(Icon_1.default,{height:"1.5rem",width:"1.5rem",name:iconType_1.default[e.type]||"paperclip"}),react_1.default.createElement("span",{className:"lead",style:{flex:1}},e.name),react_1.default.createElement(Icon_1.default,{height:"1.5rem",width:"1.5rem",name:"trash",fill:"var(--bs-danger)",onClick:function(t){return o(function(e){return e.filter(function(e){return e.name!=t.name})})}.bind(_this,e)}))})},[l,t]);return(0,react_1.useEffect)(function(){var t,e;if(c.current){var r=new DataTransfer;try{for(var n=__values(l),a=n.next();!a.done;a=n.next()){var i=a.value;r.items.add(i)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}c.current.files=r.files}},[l]),(0,react_1.useEffect)(function(){var e;i.files&&0<(null==(e=i.files)?void 0:e.length)&&o(i.files)},[i.files]),(0,react_1.useEffect)(function(){var e,t;if(c.current)return(e=c.current).addEventListener("field-error",t=function(e){return u(null==(e=e.detail)?void 0:e.error)}),function(){e.removeEventListener("field-error",t)}},[]),react_1.default.createElement("div",{style:i.style,id:i.id,className:"".concat((0,aphrodite_1.css)(t.container)," ").concat(i.className||"")},react_1.default.createElement("input",{"data-name":i.name,accept:null==(e=i.accept)?void 0:e.join(","),name:i.name,style:{display:"none"},ref:c,type:"file",multiple:i.multiple,onChange:function(r){for(var e,n,a=Object.assign([],l),t=0;t<((null==(e=r.target.files)?void 0:e.length)||0);t++)!function(e){var t=null==(n=r.target.files)?void 0:n.item(e);t&&!a.some(function(e){return e.name===t.name})&&a.push(t)}(t);i.onChange&&i.onChange(a),u(""),o(a)}}),react_1.default.createElement(Button_1.default,{iconName:i.iconName||"upload",type:i.type||"light",onClick:function(){var e;return null==(e=c.current)?void 0:e.click()}},i.title||"Upload"),react_1.default.createElement("span",{className:"invalid-feedback",style:n?{display:"block"}:void 0},n),i.children||r)});exports.default=Uploader;