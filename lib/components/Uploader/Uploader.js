"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__read=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||0<t--)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o},__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_this=this,jsx_runtime_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("react/jsx-runtime")),react_1=__importStar(require("react")),aphrodite_1=require("../../helpers/aphrodite"),Button_1=__importDefault(require("../Button")),Icon_1=__importDefault(require("../Icon")),Uploader_styles_1=require("./Uploader.styles"),iconType_1=__importDefault(require("./iconType")),Uploader=react_1.default.memo(function(o){var e=o.title,e=void 0===e?"Upload":e,t=o.showList,t=void 0===t||t,r=o.type,r=void 0===r?"primary":r,n=o.className,n=void 0===n?"":n,i=o.iconName,i=void 0===i?"upload":i,a=o.size,a=void 0===a?"base":a,l=o.error,u=void 0===l?"":l,s=o.onChange,l=o.bgAlpha,c=(0,Uploader_styles_1.useStyles)({size:a,bgAlpha:void 0===l?80:l}),l=__read((0,react_1.useState)(o.files||[]),2),f=l[0],d=l[1],l=__read((0,react_1.useState)(u),2),_=l[0],p=l[1],m=(0,react_1.useRef)(null),l=((0,react_1.useEffect)(function(){p(u||"")},[u]),(0,react_1.useMemo)(function(){return f.map(function(e){return(0,jsx_runtime_1.jsxs)("div",{className:(0,aphrodite_1.css)(c.fileItem),children:[(0,jsx_runtime_1.jsx)(Icon_1.default,{height:"1.5rem",width:"1.5rem",name:iconType_1.default[e.type]||"paperclip"}),(0,jsx_runtime_1.jsx)("span",{style:{flex:1},children:e.name}),(0,jsx_runtime_1.jsx)(Icon_1.default,{height:"1.5rem",width:"1.5rem",name:"trash",className:(0,aphrodite_1.css)(c.deleteIcon),onClick:function(t){return d(function(e){return e.filter(function(e){return e.name!=t.name})})}.bind(_this,e)})]},e.name)})},[f,c]));return(0,react_1.useEffect)(function(){var t,e;if(m.current){var r=new DataTransfer;try{for(var n=__values(f),i=n.next();!i.done;i=n.next()){var a=i.value;r.items.add(a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}m.current.files=r.files}},[f]),(0,react_1.useEffect)(function(){d(o.files||[])},[o.files]),(0,react_1.useEffect)(function(){var e,t;if(m.current)return(e=m.current).addEventListener("field-error",t=function(e){return p(null==(e=e.detail)?void 0:e.error)}),function(){e.removeEventListener("field-error",t)}},[]),(0,jsx_runtime_1.jsxs)("div",{style:o.style,id:o.id,className:"".concat((0,aphrodite_1.css)(c.container)," ").concat(n),children:[(0,jsx_runtime_1.jsx)("input",{"data-name":o.name,accept:null==(n=o.accept)?void 0:n.join(","),name:o.name,style:{display:"none"},ref:m,type:"file",multiple:o.multiple,onChange:function(r){var e,n;if(o.multiple){for(var i=Object.assign([],f),t=0;t<((null==(e=r.target.files)?void 0:e.length)||0);t++)!function(e){var t=null==(n=r.target.files)?void 0:n.item(e);t&&!i.some(function(e){return e.name===t.name})&&i.push(t)}(t);d(i),s&&s(i)}else{var a=null==(a=r.target.files)?void 0:a.item(0);a&&(d([a]),s)&&s([a])}p("")}}),(0,jsx_runtime_1.jsx)(Button_1.default,{loader:o.loader,block:o.block,disabled:o.disabled,htmlType:"button",outline:o.outline,size:a,leftIcon:i,type:r,onClick:function(){var e;return null==(e=m.current)?void 0:e.click()},children:e}),_?(0,jsx_runtime_1.jsx)("span",{className:(0,aphrodite_1.css)(c.errorFeedback),children:_}):null,t?l:null]})});Uploader.displayName="Uploader",exports.default=Uploader;