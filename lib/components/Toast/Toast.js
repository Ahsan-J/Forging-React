"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&("get"in s?t.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,s)}:function(e,t,r,a){e[a=void 0===a?r:a]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__read=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,s,n=r.call(e),o=[];try{for(;(void 0===t||0<t--)&&!(a=n.next()).done;)o.push(a.value)}catch(e){s={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},jsx_runtime_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("react/jsx-runtime")),react_1=__importStar(require("react")),react_dom_1=__importDefault(require("react-dom")),Icon_1=__importDefault(require("../Icon")),Progress_1=__importDefault(require("../Progress")),aphrodite_1=require("../../helpers/aphrodite"),Toast_styles_1=require("./Toast.styles"),Toast=react_1.default.forwardRef(function(a,e){var t=a.className,t=void 0===t?"":t,r=a.direction,r=void 0===r?"top-right":r,s=a.progress,n=void 0===s||s,s=a.autoDismissTimeout,o=void 0===s?2500:s,s=__read((0,react_1.useState)(!!a.show),2),i=s[0],c=s[1],s=__read((0,react_1.useState)(a.title||""),2),u=s[0],l=s[1],s=__read((0,react_1.useState)(a.children),2),d=s[0],_=s[1],s=__read((0,react_1.useState)(a.type),2),f=s[0],m=s[1],h=(0,Toast_styles_1.useStyles)({show:i,direction:r}),p=(0,react_1.useRef)(),w=(0,react_1.useRef)(null),y=(0,react_1.useRef)(null),v=(0,react_1.useRef)(0),b=(0,react_1.useRef)(0);(0,react_1.useEffect)(function(){c(!!a.show)},[a.show]),(0,react_1.useEffect)(function(){var e,t,r;window.clearTimeout(v.current),window.clearInterval(b.current),"show"in a||!i||!o||(n?(t=o/100,r=100,null!=(e=w.current)&&e.setProgress(100),window.clearInterval(b.current),b.current=window.setInterval(function(){var e;if(r<0)return v.current=window.setTimeout(function(){return c(!1)},t),window.clearInterval(b.current);r-=1,null!=(e=w.current)&&e.unsafeShowProgress(r)},t)):v.current=window.setTimeout(function(){return c(!1)},o))},[i,a,o,n]),(0,react_1.useEffect)(function(){var e=document.body;p.current=p.current||document.createElement("section"),p.current.setAttribute("class",(0,aphrodite_1.css)(h.sectionWrapper)),p.current.setAttribute("data-testid","ToastSectionWrapper"),p.current&&(e.className="".concat(e.className.replace((0,aphrodite_1.css)(h.body),"")," ").concat((0,aphrodite_1.css)(h.body)).trim(),e.appendChild(p.current))},[i,h]),(0,react_1.useImperativeHandle)(e,function(){return{showToast:function(e){"title"in e&&l(e.title),"body"in e&&_(e.body),"type"in e&&m(e.type),c(!("show"in e)||e.show)}}},[]);return p.current?react_dom_1.default.createPortal((0,jsx_runtime_1.jsxs)("div",{ref:y,"data-testid":"ToastContainer",onAnimationEnd:function(){var e=document.body;!i&&y.current&&(e.className=e.className.replace((0,aphrodite_1.css)(h.body),""),y.current.className=y.current.className.trim()+" show")},id:a.id,style:a.style,className:"toast show border border-".concat(f," ").concat((0,aphrodite_1.css)(h.container)," ").concat(t).trim(),role:"alert","aria-live":"assertive","aria-atomic":"true",children:[i&&u&&"string"==typeof u?(0,jsx_runtime_1.jsx)("div",{"data-testid":"ToastHeader",className:"toast-header",children:(0,jsx_runtime_1.jsx)("strong",{className:"mr-auto text-".concat(f),children:u})}):null,i&&u&&"string"!=typeof u?(0,jsx_runtime_1.jsx)("div",{"data-testid":"ToastHeader",className:"toast-header",children:u}):null,i?(0,jsx_runtime_1.jsx)(Icon_1.default,{name:"x",width:"1.5rem",height:"1.5rem",className:(0,aphrodite_1.css)(h.closeBtn),onClick:function(){window.clearTimeout(v.current),window.clearInterval(b.current),c(!1),a.onDismiss&&a.onDismiss()}}):null,i&&d?(0,jsx_runtime_1.jsx)("div",{"data-testid":"ToastBody",className:"toast-body",children:d}):null,i&&o&&n?(0,jsx_runtime_1.jsx)(Progress_1.default,{ref:w,"data-testid":"ToastProgress",type:f,className:(0,aphrodite_1.css)(h.progress)}):null]}),p.current):null});exports.default=Toast;