"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},__read=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)s.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return s},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},jsx_runtime_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("react/jsx-runtime")),react_1=require("react"),Pagination_1=__importDefault(require("../Pagination/Pagination")),aphrodite_1=require("../../helpers/aphrodite"),Table_styles_1=require("./Table.styles"),utility_1=require("../../helpers/utility"),Icon_1=__importDefault(require("../Icon")),Spinner_1=__importDefault(require("../Spinner"));function Table(o){var n=o.onSortData,t=o.onPageChange,r=o.onRowItemClick,a=o.rowClass,s=o.renderOnRowHover,e=void 0===(e=o.className)?"":e,l=void 0===(c=o.pageSize)?10:c,i=void 0===(c=o.currentPage)?1:c,c=void 0===(c=o.bgAlpha)?80:c,u=void 0===(d=o.autoSort)||d,d=void 0===(d=o.showNumberLength)?6:d,_=void 0===(P=o.size)?"base":P,m=(0,react_1.useId)(),f=(P=__read((0,react_1.useState)(),2))[0],p=P[1],h=(P=__read((0,react_1.useState)("asc"),2))[0],x=P[1],y=(P=__read((0,react_1.useState)(i),2))[0],g=P[1],j=(P=__read((0,react_1.useState)(null),2))[0],b=P[1],v=(0,Table_styles_1.useStyles)({clickable:!!r,size:_,bgAlpha:c}),k=(0,react_1.useRef)(null),C=(0,react_1.useRef)(null),S=(0,react_1.useMemo)(function(){return"function"==typeof o.data?o.data(y-1):o.data&&o.data instanceof Array&&0<o.data.length?o.data:[]},[o,y]),I=(0,react_1.useMemo)(function(){return Object.keys(S).length},[S]),w=(0,react_1.useMemo)(function(){return Object.keys(o.columnHeadings||{}).length},[o.columnHeadings]),N=(0,react_1.useMemo)(function(){return o.total||I},[o.total,I]),M=(0,react_1.useCallback)(function(e,t){x(t),p(e),n&&n(e,t)},[n]),P=((0,react_1.useEffect)(function(){"string"!=typeof i&&"number"!=typeof i||g(parseInt("".concat(i),10))},[i]),(0,react_1.useCallback)(function(e){"number"!=typeof o.currentPage&&g(e),t&&t(e)},[t,o.currentPage])),R=(0,react_1.useCallback)(function(e,t){r&&r(e,t+y*l)},[y,r,l]),q=(0,react_1.useCallback)(function(r,a,e){var t,n=(null==(n=null==(n=r.keyIndex)?void 0:n.toString())?void 0:n.split(",")).reduce(function(e,t){var n="".concat(t).split(".");return 0<n.length?(n=n.reduce(function(e,t){return e&&"object"==typeof e?e[t]:e},a),e[t]=n):e[r.keyIndex]="".concat(t||""),e},{});return r.render?(t=1<Object.keys(n).length?n:n[r.keyIndex],e+=(y-1)*(o.pageSize||1),r.render(t,r.keyIndex,e)):"string"==typeof(t=n[r.keyIndex])||"number"==typeof t?t:"N/A"},[y,o.pageSize]),O=(0,react_1.useCallback)(function(e){return void 0===(null==e?void 0:e.sortIndex)?null==e?void 0:e.keyIndex:null==e?void 0:e.sortIndex},[]),z=(0,react_1.useCallback)(function(e){return f?null==e?void 0:e.sort(function(e,t){return e=e[f],t=t[f],"number"==typeof e&&"number"==typeof t?"asc"==h?e-t:t-e:"string"==typeof e&&"string"==typeof t?"asc"==h?e.localeCompare(t):t.localeCompare(e):0}):e},[f,h]),c=(0,react_1.useMemo)(function(){var e;return null==(e=o.columnHeadings)?void 0:e.map(function(e,t){var n=O(e);return(0,jsx_runtime_1.jsxs)("th",{scope:"col",onClick:function(){e.sortable&&M(n,f===n&&"asc"===h?"desc":"asc")},id:m+e.keyIndex.toString(),style:__assign({cursor:e.sortable?"pointer":"default"},e.style),children:[e.renderColumn?e.renderColumn(e,t):e.label||e.keyIndex.toString(),e.sortable&&(f===n?(0,jsx_runtime_1.jsx)(Icon_1.default,{name:"asc"===h?"caret-up-fill":"caret-down-fill"}):(0,jsx_runtime_1.jsx)(Icon_1.default,{name:"caret-right-fill"}))]},e.keyIndex.toString())})},[O,f,h,o.columnHeadings,m,M]),D=(0,react_1.useMemo)(function(){return o.loading||0==N?(0,jsx_runtime_1.jsx)("tr",{children:(0,jsx_runtime_1.jsx)("td",{colSpan:w,children:(0,jsx_runtime_1.jsx)("div",{className:(0,aphrodite_1.css)(v.loadingContainer),children:o.loading?(0,jsx_runtime_1.jsx)(Spinner_1.default,{loader:o.loading,size:_}):(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[(0,jsx_runtime_1.jsx)(Icon_1.default,{width:"3rem",height:"3rem",name:"folder-x"}),(0,jsx_runtime_1.jsx)("p",{children:"No Data"})]})})})}):null},[o.loading,N,w,v.loadingContainer,_]),H=(0,react_1.useMemo)(function(){var e=u?z(S):S;return null==(e=S.length&&"number"!=typeof o.currentPage?(0,utility_1.chunkArray)(e,l)[y-1]:e)?void 0:e.map(function(n,r){var e;return(0,jsx_runtime_1.jsx)("tr",{onMouseEnter:s?b.bind(null,n):void 0,onClick:R.bind(null,n,r),style:o.rowStyle,className:"".concat((0,aphrodite_1.css)(v.tableRowClass)," ").concat((null==a?void 0:a(n,r))||""),children:null==(e=o.columnHeadings)?void 0:e.map(function(e,t){return e.primaryColumn?(0,jsx_runtime_1.jsx)("th",{scope:"row",headers:m+e.keyIndex.toString(),style:e.style,className:e.className,children:q(e,n,r)},"".concat(r,"-").concat(t)):(0,jsx_runtime_1.jsx)("td",{headers:m+e.keyIndex.toString(),style:e.style,className:e.className,children:q(e,n,r)},"".concat(r,"-").concat(t))})},"".concat(r,"-").concat(y))})},[u,S,l,m,o.currentPage,o.columnHeadings,o.rowStyle,z,y,v,s,a,R,q]),T=(0,react_1.useCallback)(function(e){var t,n;s&&j&&C.current&&k.current&&(t=k.current.getBoundingClientRect(),n=e.clientX-t.left+5,e=e.clientY-t.top+5,C.current.style.transform="translate(".concat(n,"px,").concat(e,"px)"))},[j,s]);return w<=0?null:(0,jsx_runtime_1.jsxs)("table",{id:o.id,"data-testid":o.id,ref:k,className:"".concat((0,aphrodite_1.css)(v.container)," ").concat(e),style:o.style,children:[(0,jsx_runtime_1.jsx)("thead",{children:(0,jsx_runtime_1.jsx)("tr",{className:"".concat((0,aphrodite_1.css)(v.tableRowClass)," ").concat(o.headerRowClass||""),children:c})}),(0,jsx_runtime_1.jsxs)("tbody",{onMouseMove:T,onMouseLeave:b.bind(null,null),children:[D,H,s&&j?(0,jsx_runtime_1.jsx)("tr",{ref:C,className:"".concat((0,aphrodite_1.css)(v.hoverRow)," ").concat(o.hoverWrapperClassName||""),children:(0,jsx_runtime_1.jsx)("td",{colSpan:w,children:null==s?void 0:s(j,0)})}):null]}),l&&0<N&&l<N?(0,jsx_runtime_1.jsx)("tfoot",{children:(0,jsx_runtime_1.jsx)("tr",{className:"".concat((0,aphrodite_1.css)(v.tableRowClass)," ").concat(o.footerRowClass||""),style:{borderWidth:0},children:(0,jsx_runtime_1.jsx)("td",{colSpan:w,children:(0,jsx_runtime_1.jsx)(Pagination_1.default,{size:_,className:(0,aphrodite_1.css)(v.pagination),type:o.type,disabled:o.loading,onItemClick:P,showNumberLength:d,total:N/l,currentPage:y})})})}):null]})}Table.displayName="Table",exports.default=Table;