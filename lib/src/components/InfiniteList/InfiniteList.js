"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(e[c]=r[c]);return e}).apply(this,arguments)},__rest=this&&this.__rest||function(e,r){var t={};for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(t[c]=e[c]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,c=Object.getOwnPropertySymbols(e);n<c.length;n++)r.indexOf(c[n])<0&&Object.prototype.propertyIsEnumerable.call(e,c[n])&&(t[c[n]]=e[c[n]]);return t},jsx_runtime_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("react/jsx-runtime")),react_1=require("react");function InfiniteList(e){var r=e.data,t=void 0===r?[]:r,n=e.renderItem,r=e.isReverse,c=void 0!==r&&r,s=e.onEndReach,r=e.debounce,r=void 0===r?1e3:r,u=e.threshold,o=void 0===u?200:u,i=e.wrapper,u=e.hasMore,a=void 0!==u&&u,l=e.page,u=__rest(e,["data","renderItem","isReverse","onEndReach","debounce","threshold","wrapper","hasMore","page"]),f=(0,react_1.useRef)(null),_=(0,react_1.useRef)(!0),p=(0,react_1.useRef)(0),d=(0,react_1.useRef)(1),g=(0,react_1.useRef)(r),h=((0,react_1.useEffect)(function(){"number"==typeof l&&0<l&&(d.current=l)},[l]),(0,react_1.useCallback)(function(e){a&&(c&&1==_.current&&e.target.scrollTop<=(o||0)&&(s&&p.current>e.target.scrollTop&&(s(e,d.current),d.current=d.current+1),0<g.current)&&(_.current=!1,setTimeout(function(){return _.current=!0},g.current)),!c&&1==_.current&&e.target.scrollHeight-e.target.scrollTop-(o||0)<=e.target.clientHeight&&(s&&p.current<e.target.scrollTop&&(s(e,d.current),d.current=d.current+1),0<g.current)&&(_.current=!1,setTimeout(function(){return _.current=!0},g.current)),p.current=e.target.scrollTop)},[c,a,o,s])),e=((0,react_1.useEffect)(function(){if(!i&&a&&f.current){var e=f.current.parentElement;if(e)return null!=e&&e.addEventListener("scroll",h),c&&null!=e&&e.scrollTo(0,null==e?void 0:e.scrollHeight),function(){null!=e&&e.removeEventListener("scroll",h)}}},[h,a,c,i]),(0,react_1.useEffect)(function(){var e;if(i&&a&&f.current)return(e=f.current).addEventListener("scroll",h),c&&e.scrollTo(0,e.scrollHeight),function(){e.removeEventListener("scroll",h)}},[a,i,h,c]),(0,react_1.useMemo)(function(){return Array.isArray(t)?t.map(function(e,r){return n?n(e,r):e}):null},[t,n]));return i?(0,react_1.createElement)(i,__assign(__assign({ref:f},u),{"data-testid":u.id}),(0,jsx_runtime_1.jsx)(jsx_runtime_1.Fragment,{children:e})):(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[(0,jsx_runtime_1.jsx)("span",{ref:f,style:{display:"none"}}),e]})}exports.default=InfiniteList;